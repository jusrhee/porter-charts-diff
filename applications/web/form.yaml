name: Web
hasSource: registry-only
tabs:
  - name: main
    label: Main
    sections:
      - name: section_one
        contents:
          - type: heading
            label: Container Settings
          - type: variable
            variable: showStartCommand
            settings:
              default: true
      - name: command
        show_if: showStartCommand
        contents:
          - type: subtitle
            name: command_description
            label: (Optional) Set a start command for this service.
          - type: string-input
            label: Start Command
            placeholder: "ex: sh ./script.sh"
            variable: container.command
            settings:
              default: ""
      - name: section_one_cont
        contents:
          - type: subtitle
            label: Specify the port your application is running on.
          - type: number-input
            variable: container.port
            label: Container Port
            placeholder: "ex: 8080"
            settings:
              default: 8080
          - type: heading
            label: Deploy Webhook
          - type: checkbox
            variable: auto_deploy
            label: Auto-deploy when webhook is called.
            settings:
              default: true
      - name: network
        contents:
          - type: heading
            label: Network Settings
          - type: subtitle
            label: For containers that you do not want to expose to external traffic (e.g. databases and add-ons), you may make them accessible only to other internal services running within the same cluster.
          - type: checkbox
            variable: ingress.enabled
            label: Expose to external traffic
            settings:
              default: true
      - name: domain_name
        show_if: ingress.enabled
        contents:
          - type: array-input
            variable: ingress.hosts
            label: Domain Name
            settings:
              required: true
      - name: cert_issuer
        show_if: ingress.enabled
        contents:
          - type: subtitle
            label: The cert-manager issuer. Don't typically need to change.
          - type: string-input
            variable: certIssuer
            label: Cert Issuer
            settings:
              required: true
              default: "letsencrypt-prod"
      - name: http_timeout
        contents:
          - type: subtitle
            label: The amount of time in seconds before a http request is aborted.
          - type: number-input
            variable: httpTimeout
            label: HTTP Timeout
            settings:
              unit: s
              required: true
              default: "30"
  - name: datadog
    label: Datadog
    sections:
      - name: main_section
        contents:
          - type: heading
            label: Datadog
          - type: subtitle
            label: Configure Datadog settings. These are used as tags in datadog eg env:int service:my_app.
          - type: string-input
            label: Datadog Service (DD_SERVICE and tags.datadoghq.com/service)
            placeholder: "ex: my_app"
            variable: datadog.service
            settings:
              required: true
          - type: string-input
            label: Datadog Env  (DD_ENV and tags.datadoghq.com/env)
            placeholder: "ex: int"
            variable: datadog.env
            settings:
              required: true
  - name: resources
    label: Resources
    sections:
      - name: main_section
        contents:
          - type: heading
            label: Resources
          - type: subtitle
            label: Configure resources assigned to this container.
          - type: heading
            label: Requests
          - type: number-input
            label: RAM
            variable: resources.requests.memory
            placeholder: "ex: 256"
            settings:
              required: true
              unit: Mi
              default: 256
          - type: number-input
            label: CPU
            variable: resources.requests.cpu
            placeholder: "ex: 100"
            settings:
              required: true
              unit: m
              default: 100
          - type: number-input
            label: Replicas
            variable: replicaCount
            placeholder: "ex: 1"
            settings:
              required: true
              default: 1
          - type: checkbox
            variable: autoscaling.enabled
            label: Enable autoscaling
            settings:
              default: false
      - name: autoscaler
        show_if: autoscaling.enabled
        contents:
          - type: number-input
            label: Minimum Replicas
            variable: autoscaling.minReplicas
            placeholder: "ex: 1"
            settings:
              default: 1
          - type: number-input
            label: Maximum Replicas
            variable: autoscaling.maxReplicas
            placeholder: "ex: 10"
            settings:
              default: 10
          - type: number-input
            label: Target CPU Utilization
            variable: autoscaling.targetCPUUtilizationPercentage
            placeholder: "ex: 50"
            settings:
              omitUnitFromValue: true
              unit: "%"
              default: 50
          - type: number-input
            label: Target RAM Utilization
            variable: autoscaling.targetMemoryUtilizationPercentage
            placeholder: "ex: 50"
            settings:
              omitUnitFromValue: true
              unit: "%"
              default: 50
  - name: env
    label: Environment
    sections:
      - name: env_vars
        contents:
          - type: heading
            label: Environment Variables
          - type: subtitle
            label: Set environment variables for your secrets and environment-specific configuration.
          - type: env-key-value-array
            label:
            variable: container.env
  - name: advanced
    label: Advanced
    sections:
      - name: health_check
        contents:
          - type: heading
            label: Custom Health Checks
          - type: subtitle
            label: Define custom health check endpoints to ensure zero down-time deployments.
      - name: startup_check
        contents:
          - type: checkbox
            label: Enable Startup Probe
            variable: health.startupProbe.enabled
            settings:
              default: false
      - name: startup_check_endpoint
        show_if: health.startupProbe.enabled
        contents:
          - type: heading
            label: Startup Probe
          - type: string-input
            label: Startup Check Endpoint
            variable: health.startupProbe.path
            placeholder: "ex: /health_check"
            settings:
              required: true
              default: /health_check
          - type: string-input
            variable: health.startupProbe.port
            label: Startup Probe Port
            placeholder: "ex: http"
            settings:
              required: true
              default: http
          - type: heading
            label: Custom Startup Check Rules
          - type: subtitle
            label: Configure how many times a startup check will be performed before deeming the container as failed.
          - type: number-input
            label: Failure Threshold
            variable: health.startupProbe.failureThreshold
            placeholder: "ex: 3"
          - type: subtitle
            label: Configure the interval at which the startup check is repeated in the case of failure.
          - type: number-input
            label: Repeat Interval
            variable: health.startupProbe.periodSeconds
            placeholder: "ex: 30"
      - name: liveness_check
        contents:
          - type: checkbox
            variable: health.livenessProbe.enabled
            label: Enable Liveness Probe
            settings:
              default: false
      - name: liveness_check_endpoint
        show_if: health.livenessProbe.enabled
        contents:
          - type: heading
            label: Liveness Probe
          - type: string-input
            label: Liveness Check Endpoint
            variable: health.livenessProbe.path
            placeholder: "ex: /health_check"
            settings:
              required: true
              default: /health_check
          - type: string-input
            variable: health.livenessProbe.port
            label: Liveness Probe Port
            placeholder: "ex: http or 9393"
            settings:
              required: true
              default: http
          - type: heading
            label: Custom Liveness Check Rules
          - type: subtitle
            label: Configure how many times a liveness check will be performed before deeming the container as failed.
          - type: number-input
            label: Failure Threshold
            variable: health.livenessProbe.failureThreshold
            placeholder: "ex: 3"
          - type: subtitle
            label: Configure the interval at which liveness check is repeated in the case of failure.
          - type: number-input
            label: Repeat Interval
            variable: health.livenessProbe.periodSeconds
            placeholder: "ex: 30"
      - name: readiness_check
        contents:
          - type: checkbox
            label: Enable Readiness Probe
            variable: health.readinessProbe.enabled
            settings:
              default: false
      - name: readiness_probe
        show_if: health.readinessProbe.enabled
        contents:
          - type: heading
            label: Readiness Probe
          - type: subtitle
            label: Configure readiness probe to decide whether traffic should be directed to a pod.
          - type: string-input
            label: Readiness Probe Endpoint
            variable: health.readinessProbe.path
            settings:
              default: /health_check
          - type: string-input
            variable: health.readinessProbe.port
            label: Readiness Probe Port
            placeholder: "ex: http"
            settings:
              required: true
              default: http
          - type: heading
            label: Custom Readiness Check Rules
          - type: subtitle
            label: Configure how many times a readiness check will be performed before deeming the container as failed.
          - type: number-input
            label: Failure Threshold
            variable: health.readinessProbe.failureThreshold
            placeholder: "ex: 3"
          - type: subtitle
            label: Configure the interval at which readiness check is repeated in the case of failure.
          - type: number-input
            label: Repeat Interval
            variable: health.readinessProbe.periodSeconds
            placeholder: "ex: 30"
      - name: termination_grace_period
        contents:
          - type: heading
            label: Termination Grace Period
          - type: subtitle
            label: Specify how much time app processes have to gracefully shut down on SIGTERM.
          - type: number-input
            label: Termination Grace Period (seconds)
            variable: terminationGracePeriodSeconds
            placeholder: "ex: 30"
            settings:
              default: 30
      - name: container_hooks
        contents:
          - type: heading
            label: Container hooks
          - type: subtitle
            label: (Optional) Set post start or pre stop commands for this service.
          - type: string-input
            label: Post start command
            placeholder: "ex: /bin/sh ./myscript.sh"
            variable: container.lifecycle.postStart
          - type: string-input
            label: Pre stop command
            placeholder: "ex: /bin/sh ./myscript.sh"
            variable: container.lifecycle.preStop
      - name: maintenance_page
        contents:
          - type: heading
            label: Maintenance Mode Settings
          - type: subtitle
            label: Maintenance Page will be displayed instead of your app page
          - type: checkbox
            variable: ingress.maintenance.enabled
            label: Enable
            settings:
              default: false
      - name: sidekiq_ui
        contents:
          - type: heading
            label: Sidekiq UI
          - type: subtitle
            label: Configures authentication for sidekiq ui. Make sure you serve /sidekiq from your app without additional auth.
          - type: checkbox
            variable: sidekiq.ui.enabled
            label: Enable
            settings:
              default: false
